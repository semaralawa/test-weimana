<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WEIMANA</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>

<body>
    <div class="container">
        <div class="p-3 border border-1 mb-5 sticky-top bg-white">
            <ul class="nav nav-pills nav-fill" id="myTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="tab1-tab" data-bs-toggle="tab" data-bs-target="#tab1-tab-pane"
                        type="button" role="tab" aria-controls="tab1-tab-pane"
                        aria-selected="true">CONFIGURATION</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tab2-tab" data-bs-toggle="tab" data-bs-target="#tab2-tab-pane"
                        type="button" role="tab" aria-controls="tab2-tab-pane" aria-selected="true">STATUS</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tab3-tab" data-bs-toggle="tab" data-bs-target="#tab3-tab-pane"
                        type="button" role="tab" aria-controls="tab3-tab-pane" aria-selected="true">WEBSERVER</button>
                </li>
            </ul>
        </div>
        <form action="" method="post">
            <div class="tab-content">
                <!-- tab1 -->
                <div class="tab-pane fade show active" id="tab1-tab-pane" role="tabpanel" aria-labelledby="tab1-tab"
                    tabindex="0">
                    <div class="container">
                        <div class="row justify-content-between">
                            <!-- col kiri -->
                            <div class="col-lg-4">
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">Controller Type</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p1" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <!-- parameter -->
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">Developer</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p2" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">Serial Number</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p3" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">Firmware Version</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p4" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Battery Max Volt
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Tentukan nilai tegangan full charge Battery, Max 60 volt"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p5" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Controller Low Volt
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Tentukan batas minimal tegangan kontroler"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p6" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Controller Over Volt
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Tentukan batas maksimal tegangan kontroler"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p7" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Phase Current
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Tentukan batas limit Arus Phase dalam satuan Ampere"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p8" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Battery Power
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Tentukan batas limit Baterai Power dalam satuan Watt"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p9" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Motor Identify Angle
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Set nilai 170 untuk aktifkan auto motor angle identification lalu restart controller"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p10" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <!-- parameter -->
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Throttle Low
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Batas bawah tegangan throttle rentang 0 - 2V atau set nilai 0 sampai 20"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p11" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <!-- parameter -->
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Throttle High
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Batas atas tegangan throttle rentang 3 - 5V atau set nilai 30 sampai 50"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p12" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Throttle Dead Low
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Batas bawah tegangan gas throttle rentang 0 - 5V atau set nilai 0 sampai 50"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p13" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Throttle Dead High
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Batas atas tegangan gas throttle rentang 0 - 5V atau set nilai 0 sampai 50"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p14" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Max Output Freq
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Max kecepatan frekuensi motor rentang 50 - 1000Hz"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p15" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Max RPM
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Max RPM motor rentang 50 - 60000 RPM"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p16" type="text" class="form-control" value="">
                                    </div>
                                </div>
                            </div>
                            <!-- col tengah -->
                            <div class="col-lg-4">
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Max Forw Speed%
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Max persentase RPM motor maju, 100% = Max RPM"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p17" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Max Rev Speed%
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Max persentase RPM motor mundur, 100% = Max RPM"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p18" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        PWM Frequency
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Set nilai frekuesi PWM, rentang 10 - 20Khz"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p19" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Accel Time
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="set respon akselesari gas dari 1 - 250"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p20" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <!-- parameter -->
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Accel Release Time
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="set respon lepas gas dari 1 - 250" data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p21" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <!-- parameter -->
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Torque Speed Kp
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Set PID, gain P rentang 0~10000" data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p22" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Torque Speed Ki
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Set PID, gain I rentang 0~500" data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p23" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Torque Speed Kd
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Set PID, gain D rentang 50~4000" data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p24" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Motor Nominal Current
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Ketika dilakukan mode auto motor identification parameter ini digunakan sebagai arus phase nominal scanning"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p25" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Controller Temp Cut
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Suhu cutoff kontroler rentang 0~100 derajat celcius"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p26" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Motor Temp Cut Off
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Suhu cutoff motor rentang 0~100 derajat celcius"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p27" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Motor Poles
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Jumlah pasang kutub motor, digunakan untuk kalkulasi RPM motor"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p28" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Iq Kp
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Set PI, gain P pada torque FOC, rentang 1~1000"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p29" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Iq Ki
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Set PI, gain I pada torque FOC, rentang 1~500"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p30" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <!-- parameter -->
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Id Kp
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Set PI, gain P pada flux FOC, rentang 1~1000"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p31" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <!-- parameter -->
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Id Ki
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Set PI, gain I pada flux FOC, rentang 1~500"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p32" type="text" class="form-control" value="">
                                    </div>
                                </div>
                            </div>
                            <!-- col kanan -->
                            <div class="col-lg-4">
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Motor Sens Type
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="0= none, 1= KTY84-130/150, 2= KTY83/122"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p33" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        REGEN current
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Tentukan nilai ampere max regen current"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p34" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        REGEN Brake Percent
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Tentukan persentase regen brake 0~90%"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p35" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Field Weakening
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="Tentukan nilai ampere Field Weakening"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p36" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Reserve
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-title=""
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p37" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Reserve
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-title=""
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p38" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Reserve
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-title=""
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p39" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Reserve
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-title=""
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p40" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Reserve
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-title=""
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p41" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Reserve
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-title=""
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p42" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Reserve
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-title=""
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p43" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Reserve
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-title=""
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="config" id="p44" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label class="col-md-7 col-form-label" class="form-check-label"
                                        for="flexSwitchCheckChecked">Switch FNR
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="allow untuk mode F-N-R control" data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a></label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <div class="form-check form-switch">
                                            <input name="config" id="p45" class="form-check-input" type="checkbox"
                                                role="switch" value="" checked>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label class="col-md-7 col-form-label" class="form-check-label"
                                        for="flexSwitchCheckChecked">Startup HI
                                        Throttle
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="allow untuk protect ketika pedal gas max saat pertama kontroller hidup"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a>
                                    </label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <div class="form-check form-switch">
                                            <input name="config" id="p46" class="form-check-input" type="checkbox"
                                                role="switch" value="" checked>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label class="col-md-7 col-form-label" class="form-check-label"
                                        for="flexSwitchCheckChecked">Change
                                        Direction
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="allow untuk merubah flip konfigurasi motor maju atau mundur"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a></label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <div class="form-check form-switch">
                                            <input name="config" id="p47" class="form-check-input" type="checkbox"
                                                role="switch" value="" checked>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label class="col-md-7 col-form-label" class="form-check-label"
                                        for="flexSwitchCheckChecked">Boost
                                        <a href="#" class="d-inline-block" data-bs-toggle="tooltip"
                                            data-bs-title="allow untuk mengaktifkan fungsi tombol boost (selama 10 detik dengan acuan nilai max baterai dan arus phase), jika disallow tombol berfungsi sebagai variable regen"
                                            data-bs-placement="right">
                                            <i class="bi bi-question-circle-fill"></i>
                                        </a></label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <div class="form-check form-switch">
                                            <input name="config" id="p48" class="form-check-input" type="checkbox"
                                                role="switch" value="" checked>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- button -->
                    <div class="sticky-bottom d-flex justify-content-center p-2 pt-3 bg-white text-center">
                        <button type="button" id="btn_read" class="btn btn-primary mx-2">Read</button>
                        <button type="button" id="btn_write" class="btn btn-success mx-2">Write</button>
                        <button type="button" id="btn_default" class="btn btn-secondary mx-2">Default</button>
                        <div class="input-group">
                            <input type="file" class="form-control" id="inputGroupFile04"
                                aria-describedby="inputGroupFileAddon04" aria-label="Upload" accept=".json">
                            <button class="btn btn-outline-secondary" type="button"
                                id="inputGroupFileApply">Apply</button>
                        </div>
                        <button type="button" id="btn_backup" class="btn btn-secondary mx-2" style="width: 200px;">
                            Backup Config
                        </button>
                    </div>
                </div>
        </form>
        <form action="" method="post">
            <div class="tab-content">
                <!-- tab2 -->
                <div class="tab-pane fade" id="tab2-tab-pane" role="tabpanel" aria-labelledby="tab2-tab" tabindex="0">
                    <div class="container">
                        <div class="row justify-content-between">
                            <div class="row  pb-3 pe-0">
                                <label for="" class="col-md-2 col-form-label">Error Status</label>
                                <div class="col-md-10 fv-row pe-0">
                                    <input name="status" id="s1" placeholder="No Error" type="text"
                                        class="form-control bg-white" value="" disabled readonly>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class=" row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Throttle Value</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="status" id="s2" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Boost/REGEN</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="status" id="s3" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <div class=" row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Forward SW</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="status" id="s4" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <div class=" row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Reversed SW</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="status" id="s5" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <div class=" row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Motor Temp</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="status" id="s6" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class=" row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Hall A</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="status" id="s7" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Hall B</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="status" id="s8" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Hall C</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="status" id="s9" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        B+ Volt</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="status" id="s10" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Controller Temp</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="status" id="s11" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Actual Dir</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="status" id="s12" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <div class=" row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Motor Frequenty</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="status" id="s13" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        Motor RPM</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="status" id="s14" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        B+ Current</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="status" id="s15" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                                <div class="row mb-lg-1 mb-2 pe-0">
                                    <label for="" class="col-md-7 col-form-label">
                                        B+ Power</label>
                                    <div class="col-md-5 fv-row my-auto">
                                        <input name="status" id="s16" type="text" class="form-control bg-white" value=""
                                            disabled readonly>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- chart -->
                    <div class="pt-5">
                        <div class="border-bottom border-1 p-2 mb-3">FOC</div>
                        <div id="chart" style="height: 350px;"></div>
                    </div>
                    <!-- button -->
                    <div class="sticky-bottom p-2 d-flex justify-content-center bg-white">
                        <button type="button" id="btn_status" class="btn btn-primary mx-2">Stream</button>
                        <!-- <button type="button" id="test_add_data" class="btn btn-primary mx-2">tambah data</button> -->
                    </div>
                </div>
        </form>

        <form action="" method="post">
            <div class="tab-content">
                <!-- tab3 -->
                <div class="tab-pane fade" id="tab3-tab-pane" role="tabpanel" aria-labelledby="tab3-tab" tabindex="0">
                    <div class="container">
                        <div class="col">
                            <div class="row mb-lg-1 mb-2 pe-0 justify-content-center">
                                <label for="" class="col-md-2 col-form-label">
                                    MAC Address</label>
                                <div class="col-md-4 fv-row my-auto">
                                    <input name="webserver" id="w1" placeholder="XX:XX:XX:XX:XX:XX" type="text"
                                        class="form-control bg-white" value="" disabled readonly>
                                </div>
                            </div>
                            <div class="row mb-lg-1 mb-2 pe-0 justify-content-center">
                                <label for="" class="col-md-2 col-form-label">
                                    Local IP</label>
                                <div class="col-md-4 fv-row my-auto">
                                    <input name="webserver" id="w2" placeholder="192.168.1.1" type="text"
                                        class="form-control bg-white" value="" disabled readonly>
                                </div>
                            </div>
                            <div class=" row mb-lg-1 mb-2 pe-0 justify-content-center">
                                <label for="" class="col-md-2 col-form-label">
                                    Hostname</label>
                                <div class="col-md-4 fv-row my-auto">
                                    <input name="webserver" id="w3" placeholder="myDevice" type="text"
                                        class="form-control" value="">
                                </div>
                            </div>
                            <div class=" row mb-lg-1 mb-2 pe-0 justify-content-center">
                                <label for="" class="col-md-2 col-form-label">
                                    SSID</label>
                                <div class="col-md-4 fv-row my-auto">
                                    <input name="webserver" id="w4" placeholder="mywifi" type="text"
                                        class="form-control" value="">
                                </div>
                            </div>
                            <div class="row mb-lg-1 mb-2 pe-0 justify-content-center">
                                <label for="" class="col-md-2 col-form-label">
                                    Password</label>
                                <div class="col-md-4 fv-row my-auto">
                                    <input name="webserver" id="w5" placeholder="mypassword" type="text"
                                        class="form-control" value="">
                                </div>
                            </div>
                            <div class=" row mb-lg-1 mb-2 pe-0 justify-content-center">
                                <label for="" class="col-md-2 col-form-label">
                                    Secondary SSID</label>
                                <div class="col-md-4 fv-row my-auto">
                                    <input name="webserver" id="w6" placeholder="mywifi" type="text"
                                        class="form-control" value="">
                                </div>
                            </div>
                            <div class="row mb-lg-1 mb-2 pe-0 justify-content-center">
                                <label for="" class="col-md-2 col-form-label">
                                    Secondary Password</label>
                                <div class="col-md-4 fv-row my-auto">
                                    <input name="webserver" id="w7" placeholder="mypassword" type="text"
                                        class="form-control" value="">
                                </div>
                            </div>
                            <div class=" row mb-lg-1 mb-2 pe-0 justify-content-center">
                                <label for="" class="col-md-2 col-form-label">
                                    mDNS</label>
                                <div class="col-md-4 fv-row my-auto">
                                    <div class="input-group mb-3">
                                        <input name="webserver" id="w8" placeholder="mydomain" type="text"
                                            class="form-control" value="">
                                        <span class="input-group-text" id="basic-addon2">.local</span>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-lg-1 mb-2 pe-0 justify-content-center">
                                <label for="" class="col-md-2 col-form-label">
                                    Baudrate</label>
                                <div class="col-md-4 fv-row my-auto">
                                    <input name="webserver" id="w9" placeholder="115200" type="text"
                                        class="form-control" value="">
                                </div>
                            </div>
                            <div class="row mb-lg-1 mb-2 pe-0 justify-content-center">
                                <label for="" class="col-md-2 col-form-label">
                                    Data Bits</label>
                                <div class="col-md-4 fv-row my-auto">
                                    <input name="webserver" id="w10" placeholder="8" type="text" class="form-control"
                                        value="">
                                </div>
                            </div>
                            <div class="row mb-lg-1 mb-2 pe-0 justify-content-center">
                                <label for="" class="col-md-2 col-form-label">
                                    Parity</label>
                                <div class="col-md-4 fv-row my-auto">
                                    <input name="webserver" id="w11" placeholder="0" type="text" class="form-control"
                                        value="">
                                </div>
                            </div>
                            <div class="row mb-lg-1 mb-2 pe-0 justify-content-center">
                                <label for="" class="col-md-2 col-form-label">
                                    Stop Bits</label>
                                <div class="col-md-4 fv-row my-auto">
                                    <input name="webserver" id="w12" placeholder="1" type="text" class="form-control"
                                        value="">
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- button -->
                    <div class="sticky-bottom p-2 d-flex justify-content-center bg-white">
                        <button type="button" id="btn_wifi_read" class="btn btn-primary mx-2">Read</button>
                        <button type="button" id="btn_wifi_save" class="btn btn-success mx-2">Save</button>
                    </div>
                </div>
            </div>
        </form>
        <!-- <div id="footer" class="footer text-center">Copyright © 2025 ngadegadicandra@gmail.com</div> -->
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.slim.min.js"
        integrity="sha256-kmHvs0B+OpCW5GVHUNjv9rOmY0IvSIRcf7zGUDTDQM8=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script>
        // --- enable tooltip
        const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
        const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))

        $(document).ready(function () {
            const errorMessages = [
                "",
                "Automatic identification error",
                "Over voltage error",
                "Low voltage error",
                "Motor did not start",
                "Over temperature",
                "Throttle error at power-up",
                "Throttle is open or short-circuit",
                "Motor Angle Sens problem",
                "Angle sensor error",
                "Automatic identification success",
                "Motor over-temperature",
                "Internal reset",
                "Reserved",
                "Reserved",
                "Reserved"
            ];
            // WebSocket connection
            let streamInterval = null;
            let isStreaming = false;
            let socket;

            function connectWebSocket() {
                // Close existing connection if any
                if (socket) {
                    socket.close();
                }

                // Create new WebSocket connection
                socket = new WebSocket(`ws://${window.location.hostname}/ws`);

                // Connection opened
                socket.addEventListener('open', function (event) {
                    console.log('WebSocket connected to:', socket.url);
                    $('#connection-status').text('Connected').css('color', 'green');
                });

                // Listen for messages
                socket.addEventListener('message', function (event) {
                    console.log('Message from server:', event.data);
                    processWebSocketMessage(event.data);
                });

                // Handle errors
                socket.addEventListener('error', function (event) {
                    console.error('WebSocket error:', event);
                    $('#connection-status').text('Error').css('color', 'red');
                });

                // Handle connection close
                socket.addEventListener('close', function (event) {
                    console.log('WebSocket disconnected');
                    $('#connection-status').text('Disconnected').css('color', 'gray');

                    // Try to reconnect after 3 seconds
                    setTimeout(connectWebSocket, 3000);
                });
            }

            // Function to process incoming WebSocket messages
            function processWebSocketMessage(message) {
                // Check if message matches the expected format *c,value1,value2,...,value48#
                if (message.startsWith('*c,') && message.endsWith('#')) {
                    // Remove the *c, and # parts
                    const dataStr = message.substring(3, message.length - 1);
                    // Split by commas
                    const values = dataStr.split(',');

                    // Update input fields if we have exactly 48 values
                    if (values.length === 48) {
                        for (let i = 0; i < 44; i++) {
                            $(`#p${i + 1}`).val(values[i]);
                        }

                        // Handle checkboxes (p45-p48)
                        for (let i = 44; i < 48; i++) {
                            const checkboxId = `p${i + 1}`;
                            // Convert value to boolean - any positive number is true
                            const isChecked = parseInt(values[i]) > 0;
                            $(`#${checkboxId}`).prop('checked', isChecked);
                        }

                    } else {
                        console.error('Received incorrect number of values:', values.length);
                    }
                }
                // Check if message matches the expected format *s,value1,value2,...,value19#
                if (message.startsWith('*s,') && message.endsWith('#')) {
                    // Remove the *s, and # parts
                    const dataStr = message.substring(3, message.length - 1);
                    // Split by commas
                    const values = dataStr.split(',');

                    // Update input fields if we have exactly 19 values
                    if (values.length === 19) {
                        $(`#s1`).val(errorMessages[values[0]]);
                        for (let i = 1; i < 16; i++) {
                            $(`#s${i + 1}`).val(values[i]);
                        }
                        addChartData(values[16], values[17], values[18]);
                    } else {
                        console.error('Received incorrect number of values:', values.length);
                    }
                }
                // Check if message matches the expected format *w,value1,value2,...,value48#
                if (message.startsWith('*w,') && message.endsWith('#')) {
                    // Remove the *w, and # parts
                    const dataStr = message.substring(3, message.length - 1);
                    // Split by commas
                    const values = dataStr.split(',');

                    // Update input fields if we have exactly 12 values
                    if (values.length === 12) {
                        for (let i = 0; i < 12; i++) {
                            $(`#w${i + 1}`).val(values[i]);
                        }
                    } else {
                        console.error('Received incorrect number of values:', values.length);
                    }
                }
            }

            // Function to collect all values
            function collectValues() {
                let values = {};
                for (let i = 5; i <= 44; i++) {
                    values[`p${i}`] = $(`#p${i}`).val() || '0'; // Use '0' if value is empty
                }
                // Handle checkboxes (p45-p48)
                for (let i = 45; i <= 48; i++) {
                    const checkboxId = `p${i}`;
                    if ($(`#${checkboxId}`).prop('checked')) {
                        values[`${checkboxId}`] = '1';
                    }
                    else {
                        values[`${checkboxId}`] = '0';
                    }
                }
                return values;
            }

            // Function to send values to WebSocket
            function collectAndSendValues() {
                const values = collectValues();
                const message = `*c,${Object.values(values).join(',')}#`;

                if (socket && socket.readyState === WebSocket.OPEN) {
                    socket.send(message);
                    console.log('Sent:', message);
                } else {
                    console.error('WebSocket is not connected');
                    // Try to reconnect
                    connectWebSocket();
                }
            }

            // Function to backup values to JSON file
            function backupValues() {
                const values = collectValues();
                const dataStr = JSON.stringify(values, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);

                const exportName = `config_${new Date().toISOString().slice(0, 10)}.json`;

                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportName);
                linkElement.click();
            }

            // Connect WebSocket when page loads
            connectWebSocket();

            // Read button click handler
            $('#btn_read').click(function () {
                if (socket && socket.readyState === WebSocket.OPEN) {
                    socket.send('*c#');
                    console.log('Sent: *c#');
                } else {
                    console.error('WebSocket is not connected');
                    // Try to reconnect
                    connectWebSocket();
                }
            });

            // Write button click handler
            $('#btn_write').click(function () {
                collectAndSendValues();
            });

            // Backup button click handler
            $('#btn_backup').click(function () {
                backupValues();
            });

            // Add connection status indicator
            $('body').prepend('<div id="connection-status" style="float: right; margin: 10px; padding: 5px; border: 1px solid black;">Connecting...</div>');

            // Apply button click handler
            $('#inputGroupFileApply').click(function () {
                const fileInput = $('#inputGroupFile04')[0];

                if (fileInput.files.length === 0) {
                    alert('Please select a JSON file first');
                    return;
                }

                const file = fileInput.files[0];
                const reader = new FileReader();

                reader.onload = function (e) {
                    try {
                        const jsonData = JSON.parse(e.target.result);

                        // Validate the JSON structure
                        if (typeof jsonData !== 'object' || jsonData === null) {
                            throw new Error('Invalid JSON format');
                        }

                        // Convert JSON object to array of values in order p1 to p48
                        const values = [];
                        for (let i = 1; i <= 48; i++) {
                            const key = `p${i}`;
                            values.push(jsonData[key] !== undefined ? jsonData[key] : '');
                        }

                        // Apply values to inputs p1 to p48
                        if (values.length === 48) {
                            // Handle regular inputs (p1-p44)
                            for (let i = 0; i < 44; i++) {
                                $(`#p${i + 1}`).val(values[i]);
                            }

                            // Handle checkboxes (p45-p48)
                            for (let i = 44; i < 48; i++) {
                                const checkboxId = `p${i + 1}`;
                                // Convert value to boolean - any positive number is true
                                const isChecked = parseInt(values[i]) > 0;
                                $(`#${checkboxId}`).prop('checked', isChecked);
                            }

                            console.log('Values applied from JSON file');
                        } else {
                            throw new Error('JSON file must contain exactly 48 values (p1-p48)');
                        }
                    } catch (error) {
                        console.error('Error parsing JSON file:', error);
                        alert('Error parsing JSON file: ' + error.message);
                    }
                };

                reader.onerror = function () {
                    alert('Error reading file');
                };

                reader.readAsText(file);
            });
            // Stream button click handler
            $('#btn_status').click(function () {
                if (!isStreaming) {
                    // Start streaming
                    isStreaming = true;
                    $(this).text('Stop').removeClass('btn-primary').addClass('btn-danger');

                    // Send immediately first time
                    if (socket && socket.readyState === WebSocket.OPEN) {
                        socket.send('*s#');
                    } else {
                        console.error('WebSocket not connected');
                        return;
                    }

                    // Set up interval for continuous sending
                    streamInterval = setInterval(function () {
                        if (socket && socket.readyState === WebSocket.OPEN) {
                            socket.send('*s#');
                        } else {
                            console.error('WebSocket not connected, stopping stream');
                            clearInterval(streamInterval);
                            $('#btn_status').text('Stream').removeClass('btn-danger').addClass('btn-primary');
                            isStreaming = false;
                        }
                    }, 10); // 10ms interval

                } else {
                    // Stop streaming
                    isStreaming = false;
                    clearInterval(streamInterval);
                    $(this).text('Stream').removeClass('btn-danger').addClass('btn-primary');
                }
            });
            // Stream button click handler
            $('#btn_wifi_read').click(function () {
                if (socket && socket.readyState === WebSocket.OPEN) {
                    socket.send('*w#');
                } else {
                    console.error('WebSocket not connected');
                    return;
                }
            });
            $('#btn_wifi_save').click(function () {
                // collect all values
                let values = {};
                for (let i = 3; i <= 12; i++) {
                    values[`w${i}`] = $(`#w${i}`).val() || '0'; // Use '0' if value is empty
                }
                // Function to send values to WebSocket
                const message = `*w,${Object.values(values).join(',')}#`;

                if (socket && socket.readyState === WebSocket.OPEN) {
                    socket.send(message);
                    console.log('Sent:', message);
                } else {
                    console.error('WebSocket is not connected');
                    // Try to reconnect
                    connectWebSocket();
                }
            });
        });

        // --- chart
        var is_reset = false;

        const chartData = {
            lastDate: new Date().getTime(),
            series: [
                {
                    name: 'IqLimit',
                    data: [],
                    color: '#FF0000' // Red
                },
                {
                    name: 'Iq',
                    data: [],
                    color: '#00FF00' // Green
                },
                {
                    name: 'Id',
                    data: [],
                    color: '#0000FF' // Blue
                }
            ],
            currentZoom: null
        };

        // Chart configuration
        const options = {
            chart: {
                type: 'line',
                height: 350,
                animations: {
                    enabled: true,
                    easing: 'linear',
                },
                zoom: {
                    enabled: true,
                    type: 'x',
                    autoScaleYaxis: false
                },
                toolbar: {
                    autoSelected: 'zoom'
                },
                events: {
                    zoomed: function (chartContext, { xaxis, yaxis }) {
                        chartData.currentZoom = { xaxis, yaxis };
                        if (is_reset) {
                            chartData.currentZoom = null;
                            is_reset = false;
                        }
                    },
                    beforeResetZoom: function (chartContext) {
                        is_reset = true;
                    }
                }
            },
            series: chartData.series,
            dataLabels: {
                enabled: false
            },
            stroke: {
                curve: 'straight',
                width: 2
            },
            markers: {
                size: 0
            },
            xaxis: {
                type: 'datetime',
                title: {
                    text: 'Time'
                }
            },
            yaxis: {
                title: {
                    text: 'Ampere'
                },
            },
            legend: {
                show: true,
                position: 'top'
            },
            colors: ['#FF0000', '#00FF00', '#0000FF'] // Red, Green, Blue
        };

        const chart = new ApexCharts(document.querySelector("#chart"), options);
        chart.render();

        // Function to add data to the chart with three parameters
        function addChartData(iqLimitValue, iqValue, idValue) {
            chartData.lastDate = new Date().getTime();

            // Append new points to all three series
            chart.addData([
                {
                    data: [{ x: chartData.lastDate, y: iqLimitValue }],
                    seriesName: 'IqLimit' // Must match the name in chartData.series
                },
                {
                    data: [{ x: chartData.lastDate, y: iqValue }],
                    seriesName: 'Iq' // Must match exactly
                },
                {
                    data: [{ x: chartData.lastDate, y: idValue }],
                    seriesName: 'Id' // Must match exactly
                }
            ], true); // 'true' = redraw once at the end (better performance)

            // Handle zoom adjustment
            if (chartData.currentZoom) {
                const range = chartData.currentZoom.xaxis.max - chartData.currentZoom.xaxis.min;
                const newMax = chartData.lastDate;
                const newMin = newMax - range;
                setTimeout(() => chart.zoomX(newMin, newMax), 50);
            }
        }
    </script>
</body>

</html>